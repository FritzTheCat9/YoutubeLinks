@page "/downloadPlaylist/{PlaylistId:int}"
@attribute [AllowAnonymous]

<PageTitle>
    @Localizer[nameof(AppStrings.DownloadPlaylist)]
</PageTitle>

@if (_playlist != null && _linkInfoList != null)
{
    <FritzBreadcrumbs Items=_items />               @* TODO: Refactor this page to be beautifull ok ok *@

    <MudText Typo=Typo.subtitle1>
        @($"Loaded {_linkInfoList.Count} links with flag downloaded = false (important - only false are loaded, when its user playlist, all when is public and not owned)")
    </MudText>

    <MudText Typo=Typo.subtitle1>
        @((int)_downloadPercent)%
    </MudText>

    <MudText>
        @_downloadingSongTitle
    </MudText>

    <FritzProcessingButton @ref=_processingButton
                           Color=Color.Primary
                           ProcessingButtonText=@Localizer[nameof(AppStrings.Downloading)]
                           ButtonText=@Localizer[nameof(AppStrings.Download)]
                           OnClick=DownloadPlaylistLinks />

    @if (_downloading)
    {
        <MudProgressLinear Color=Color.Primary
                           Striped=true
                           Size=Size.Large
                           Value=_downloadPercent
                           Class="my-7" />
    }
    else
    {
        <MudText>
            Done
        </MudText>
    }
}
